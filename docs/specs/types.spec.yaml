info:
  version: 0.0.1
  title: types generator - prompt-monitor-dashboard
groupedTypes:
  DatabaseTypes:
    # JSONB array decoder for string arrays
    StringArray:
      type: array
      items:
        type: string

    # Device Event Metadata (JSONB)
    DeviceEventMetadata:
      type: object
      properties:
        url:
          type: string
        prompt:
          type: string

    # Compliance Event Details (JSONB)
    ComplianceEventDetails:
      type: object
      properties:
        site:
          type: string
        reason:
          type: string

    # Severity enum
    Severity:
      type: string
      enum:
        - info
        - warning
        - critical

    # Supabase Error
    SupabaseError:
      type: object
      properties:
        code:
          type: string
        message:
          type: string

    # Prompt Count (query result type)
    PromptCount:
      type: object
      properties:
        device_id:
          type: string
        timestamp:
          type: number

  ApiTypes:
    # Frontend API response types
    Device:
      type: object
      required:
        - id
        - hostname
        - status
        - os
        - ip_address
        - last_seen
        - browser_count
        - prompts_today
        - total_prompts
      properties:
        id:
          type: string
        hostname:
          type: string
        status:
          type: string
          enum:
            - active
            - inactive
            - warning
            - error
            - compliance
        os:
          type: string
        ip_address:
          type: string
        last_seen:
          type: string
        browser_count:
          type: number
        prompts_today:
          type: number
        total_prompts:
          type: number
        registered_at:
          type: string
          nullable: true

    Prompt:
      type: object
      required:
        - id
        - site
        - prompt_text
        - timestamp
        - browser
        - is_flagged
      properties:
        id:
          type: string
        device_id:
          type: string
          nullable: true
        site:
          type: string
        prompt_text:
          type: string
        timestamp:
          type: number
        browser:
          type: string
        is_flagged:
          type: boolean
        url:
          type: string
          nullable: true
        username:
          type: string
          nullable: true

    DeviceEvent:
      type: object
      required:
        - id
        - event_type
        - severity
        - description
        - timestamp
      properties:
        id:
          type: string
        device_id:
          type: string
          nullable: true
        event_type:
          type: string
        severity:
          $ref: "#/groupedTypes/DatabaseTypes/Severity"
        description:
          type: string
        timestamp:
          type: number
        site:
          type: string
          nullable: true
        browser_name:
          type: string
          nullable: true
        profile_name:
          type: string
          nullable: true
        username:
          type: string
          nullable: true
        url:
          type: string
          nullable: true
        prompt:
          type: string
          nullable: true
        hostname:
          type: string
          nullable: true

    Alert:
      type: object
      required:
        - id
        - alert_type
        - severity
        - matched_pattern
        - timestamp
      properties:
        id:
          type: string
        device_id:
          type: string
          nullable: true
        alert_type:
          type: string
        severity:
          type: string
          enum:
            - warning
            - critical
          x-type-name: AlertSeverity
        matched_pattern:
          type: string
        timestamp:
          type: number

    BlockedPrompt:
      type: object
      required:
        - id
        - device_id
        - site
        - reason
        - timestamp
      properties:
        id:
          type: string
        device_id:
          type: string
        site:
          type: string
        reason:
          type: string
        timestamp:
          type: string

    DashboardStats:
      type: object
      required:
        - total_devices
        - active_devices
        - inactive_devices
        - prompts_today
      properties:
        total_devices:
          type: number
        active_devices:
          type: number
        inactive_devices:
          type: number
        prompts_today:
          type: number
